Bootstrap: docker
From: alpine:latest

%files

    unpriv_nginx.conf /etc/nginx/nginx.conf
    index.html /www/index.html

%post
    apk update
    apk add nginx

    # using /tmp will work, but this is better, although it assumes smrtlink-proxy is installed in /home/<username>/smrtlink-proxy
    sed -i 's/\/tmp/\/home\/{{ user }}\/smrtlink-proxy\/nginx/' /etc/nginx/nginx.conf
    
%startscript
    # p option is to help nginx find the log created in the post section
    nginx -p /home/{{ user }}/smrtlink-proxy/nginx/ -c /etc/nginx/nginx.conf